"0","mod.df  <- soil2 %>% "
"0","  dplyr::select(X = Lng, Y = Lat, Clay = `Clay (%)`, Silt = `Silt (%)`, Sand = `Sand (%)`, SOM = `OMC (%)`, Depth1) %>% "
"0","  group_by(X, Y) %>% "
"0","  filter(Depth1 == min(Depth1))"
"0",""
"0","Clay.df <- SpatialPointsDataFrame(mod.df[,1:2], data = mod.df[""Clay""])"
"0","proj4string(Clay.df) <- CRS(""+proj=longlat +datum=WGS84 +no_defs"")"
"0",""
"0","new.df <- as(plot_centroid, 'Spatial')"
"0",""
"0","variogram_model_clay <- variogram(Clay ~ 1, Clay.df)"
"0",""
"0","# Fit a model to the variogram"
"0","variogram_fit_clay <- fit.variogram(variogram_model_clay, model = vgm(nugget = 1, model = ""Sph"", range = 0.1, sill = 1))"
"0",""
"0","# Perform kriging"
"0","kriging_clay <- krige(Clay ~ 1, Clay.df, newdata = new.df, model = variogram_fit_clay)"
"1","[using ordinary kriging]
"
"0","krig_clay_sf <- st_as_sf(kriging_clay)"
"0",""
"0","ggplot() +"
"0","  geom_sf(data = krig_clay_sf, aes(fill = var1.pred), shape = 21, size = 4) +"
"0","  scale_fill_viridis_c('Clay content', option = ""C"") +"
"0","  theme_bw()+"
"0","    theme(panel.grid = element_blank())"
